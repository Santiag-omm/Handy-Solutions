const translations = {
    es: {
        'app.name': 'HANDY SOLUTIONS',
        'nav.home': 'Inicio',
        'nav.services': 'Servicios',
        'nav.gallery': 'Galería',
        'nav.contact': 'Contacto',
        'nav.faq': 'FAQ',
        'nav.request_service': 'Solicitar servicio',
        'nav.login': 'Iniciar sesión',
        'nav.register': 'Registrarse',
        'nav.logout': 'Cerrar sesión',
        'common.cancel': 'Cancelar',
        'common.save': 'Guardar',
        'home.hero.title': 'HANDY SOLUTIONS',
        'home.hero.subtitle': 'Soluciones profesionales de reparación para tu hogar',
        'home.hero.desc': 'Plomería, electricidad, carpintería, pintura, albañilería e impermeabilización',
        'home.services.title': 'Nuestros servicios',
        'home.gallery.title': 'Trabajos realizados',
        'home.gallery.cta': 'Ver galería',
        'services.title': 'Nuestros Servicios',
        'services.request': 'Solicitar Servicio',
        'services.empty': 'No hay servicios disponibles',
        'gallery.title': 'Galería de Trabajos',
        'gallery.load_more': 'Cargar más trabajos',
        'gallery.empty': 'No hay trabajos disponibles en la galería',
        'auth.login.title': 'Iniciar sesión',
        'auth.register.title': 'Crear cuenta',
        'auth.email': 'Correo electrónico',
        'auth.password': 'Contraseña',
        'auth.name': 'Nombre completo',
        'auth.password_confirm': 'Confirmar contraseña',
        'auth.password_min': 'Mínimo 8 caracteres',
        'auth.remember': 'Recordarme',
        'auth.login.submit': 'Entrar',
        'auth.login.no_account': '¿No tienes cuenta?',
        'auth.login.signup': 'Regístrate aquí',
        'auth.register.submit': 'Registrarse',
        'auth.register.has_account': '¿Ya tienes cuenta?',
        'auth.register.login': 'Inicia sesión aquí',

        'contact.title': 'Contáctanos',
        'contact.send': 'Enviar Mensaje',
        'contact.name': 'Nombre completo',
        'contact.email': 'Correo electrónico',
        'contact.phone': 'Teléfono',
        'contact.phone_placeholder': 'Opcional',
        'contact.subject': 'Asunto',
        'contact.subject_select': 'Selecciona un asunto',
        'contact.message': 'Mensaje',
        'contact.message_placeholder': 'Escribe tu mensaje aquí...',
        'contact.info': 'Información de Contacto',
        'contact.address': 'Dirección',
        'contact.phone_label': 'Teléfono',
        'contact.email_label': 'Correo electrónico',
        'contact.hours': 'Horario de atención',
        'contact.hours_text': 'Lunes a Viernes: 8:00 AM - 6:00 PM',
        'contact.success': '¡Mensaje enviado con éxito! Nos pondremos en contacto contigo pronto.',
        'contact.error': 'Error al enviar el mensaje. Por favor, intenta nuevamente.',
        'contact.subject_general': 'Consulta general',
        'contact.subject_service': 'Información de servicios',
        'contact.subject_quote': 'Solicitud de cotización',
        'contact.subject_complaint': 'Reclamo o queja',
        'contact.subject_other': 'Otro',
        'footer.about': 'Acerca de',
        'footer.about_text': 'Soluciones profesionales de reparación para tu hogar con más de 10 años de experiencia.',
        'footer.services': 'Servicios',
        'footer.contact_info': 'Información de Contacto',
        'footer.follow_us': 'Síguenos',
        'footer.rights': 'Todos los derechos reservados',
        'footer.privacy': 'Política de Privacidad',
        'footer.terms': 'Términos y Condiciones',
        'faq.title': 'Preguntas Frecuentes',
        'faq.subtitle': 'Encuentra respuestas a las dudas más comunes sobre nuestros servicios',
        'faq.empty': 'No hay preguntas frecuentes disponibles',
        'faq.not_found_title': '¿No encontraste lo que buscabas?',
        'faq.not_found_desc': 'Si tienes otra pregunta, no dudes en contactarnos directamente.',
        'faq.contact': 'Contactar',

        'request.title': 'Solicitar Servicio',
        'request.submit': 'Enviar Solicitud',
        'request.service': 'Servicio requerido',
        'request.service_select': 'Selecciona un servicio',
        'request.description': 'Descripción del problema',
        'request.description_placeholder': 'Describe detalladamente el problema o servicio que necesitas...',
        'request.address': 'Dirección donde se requiere el servicio',
        'request.address_placeholder': 'Calle, número, colonia, ciudad...',
        'request.phone': 'Teléfono de contacto',
        'request.phone_placeholder': 'Teléfono para comunicarnos contigo',
        'request.date': 'Fecha deseada',
        'request.date_placeholder': 'Selecciona una fecha',
        'request.time': 'Hora preferida',
        'request.time_select': 'Selecciona una hora',
        'request.notes': 'Notas adicionales',
        'request.notes_placeholder': 'Cualquier información adicional que consideres relevante...',
    },
    en: {
        'app.name': 'HANDY SOLUTIONS',
        'nav.home': 'Home',
        'nav.services': 'Services',
        'nav.gallery': 'Gallery',
        'nav.contact': 'Contact',
        'nav.faq': 'FAQ',
        'nav.request_service': 'Request service',
        'nav.login': 'Log in',
        'nav.register': 'Sign up',
        'nav.logout': 'Log out',
        'common.cancel': 'Cancel',
        'common.save': 'Save',
        'home.hero.title': 'HANDY SOLUTIONS',
        'home.hero.subtitle': 'Professional home repair solutions',
        'home.hero.desc': 'Plumbing, electrical, carpentry, painting, masonry and waterproofing',
        'home.services.title': 'Our services',
        'home.gallery.title': 'Completed work',
        'home.gallery.cta': 'View gallery',
        'services.title': 'Our Services',
        'services.request': 'Request Service',
        'services.empty': 'No services available',
        'gallery.title': 'Work Gallery',
        'gallery.load_more': 'Load more',
        'gallery.empty': 'No gallery items available',
        'auth.login.title': 'Log in',
        'auth.register.title': 'Create account',
        'auth.email': 'Email',
        'auth.password': 'Password',
        'auth.name': 'Full name',
        'auth.password_confirm': 'Confirm password',
        'auth.password_min': 'Minimum 8 characters',
        'auth.remember': 'Remember me',
        'auth.login.submit': 'Log in',
        'auth.login.no_account': "Don't have an account?",
        'auth.login.signup': 'Sign up here',
        'auth.register.submit': 'Sign up',
        'auth.register.has_account': 'Already have an account?',
        'auth.register.login': 'Log in here',

        'contact.title': 'Contact us',
        'contact.send': 'Send message',
        'contact.name': 'Full name',
        'contact.email': 'Email address',
        'contact.phone': 'Phone',
        'contact.phone_placeholder': 'Optional',
        'contact.subject': 'Subject',
        'contact.subject_select': 'Select a subject',
        'contact.message': 'Message',
        'contact.message_placeholder': 'Write your message here...',
        'contact.info': 'Contact Information',
        'contact.address': 'Address',
        'contact.phone_label': 'Phone',
        'contact.email_label': 'Email',
        'contact.hours': 'Business hours',
        'contact.hours_text': 'Monday to Friday: 8:00 AM - 6:00 PM',
        'contact.success': 'Message sent successfully! We will contact you soon.',
        'contact.error': 'Error sending message. Please try again.',
        'contact.subject_general': 'General inquiry',
        'contact.subject_service': 'Service information',
        'contact.subject_quote': 'Quote request',
        'contact.subject_complaint': 'Complaint',
        'contact.subject_other': 'Other',
        'footer.about': 'About',
        'footer.about_text': 'Professional home repair solutions with over 10 years of experience.',
        'footer.services': 'Services',
        'footer.contact_info': 'Contact Information',
        'footer.follow_us': 'Follow Us',
        'footer.rights': 'All rights reserved',
        'footer.privacy': 'Privacy Policy',
        'footer.terms': 'Terms & Conditions',
        'faq.title': 'Frequently Asked Questions',
        'faq.subtitle': 'Find answers to the most common questions about our services',
        'faq.empty': 'No FAQs available',
        'faq.not_found_title': "Didn't find what you were looking for?",
        'faq.not_found_desc': "If you have another question, feel free to contact us.",
        'faq.contact': 'Contact',

        'request.title': 'Request Service',
        'request.submit': 'Send request',
        'request.service': 'Service required',
        'request.service_select': 'Select a service',
        'request.description': 'Problem description',
        'request.description_placeholder': 'Describe in detail the problem or service you need...',
        'request.address': 'Service address',
        'request.address_placeholder': 'Street, number, neighborhood, city...',
        'request.phone': 'Contact phone',
        'request.phone_placeholder': 'Phone for us to contact you',
        'request.date': 'Preferred date',
        'request.date_placeholder': 'Select a date',
        'request.time': 'Preferred time',
        'request.time_select': 'Select a time',
        'request.notes': 'Additional notes',
        'request.notes_placeholder': 'Any additional information you consider relevant...',
    },
};

const normalizeLang = (lang) => {
    const l = (lang || '').toLowerCase();
    if (l.startsWith('es')) return 'es';
    return 'en';
};

export const getLang = () => {
    const stored = localStorage.getItem('lang');
    if (stored) return normalizeLang(stored);
    return normalizeLang(navigator.language);
};

export const setLang = (lang) => {
    localStorage.setItem('lang', normalizeLang(lang));
};

export const t = (key) => {
    const lang = getLang();
    return translations[lang]?.[key] ?? translations.es[key] ?? key;
};

export const languageSelectorHTML = () => {
    const lang = getLang();
    return `
        <select class="form-select form-select-sm" style="width:auto" onchange="window.app && window.app.setLang && window.app.setLang(this.value)">
            <option value="es" ${lang === 'es' ? 'selected' : ''}>ES</option>
            <option value="en" ${lang === 'en' ? 'selected' : ''}>EN</option>
        </select>
    `;
};
